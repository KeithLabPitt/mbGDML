

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mbgdml package &mdash; mbGDML  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mbgdml.analysis package" href="mbgdml.analysis.html" />
    <link rel="prev" title="mbgdml" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> mbGDML
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">mbgdml package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mbgdml.analysis.html">mbgdml.analysis package</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbgdml.data.html">mbgdml.data package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.calculate">mbgdml.calculate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.cli">mbgdml.cli module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.parse">mbgdml.parse module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.partition">mbgdml.partition module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.predict">mbgdml.predict module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.solvents">mbgdml.solvents module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.train">mbgdml.train module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.utils">mbgdml.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mbGDML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">mbgdml</a> &raquo;</li>
        
      <li>mbgdml package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/doc/mbgdml.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mbgdml-package">
<h1>mbgdml package<a class="headerlink" href="#mbgdml-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="mbgdml.analysis.html">mbgdml.analysis package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#module-mbgdml.analysis.nbody">mbgdml.analysis.nbody module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#module-mbgdml.analysis.similarity">mbgdml.analysis.similarity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#module-mbgdml.analysis">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mbgdml.data.html">mbgdml.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.basedata">mbgdml.data.basedata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.calculation">mbgdml.data.calculation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.dataset">mbgdml.data.dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.generate">mbgdml.data.generate module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.model">mbgdml.data.model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.predictset">mbgdml.data.predictset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.structure">mbgdml.data.structure module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mbgdml.calculate">
<span id="mbgdml-calculate-module"></span><h2>mbgdml.calculate module<a class="headerlink" href="#module-mbgdml.calculate" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mbgdml.calculate.CalcTemplate">
<em class="property">class </em><code class="descclassname">mbgdml.calculate.</code><code class="descname">CalcTemplate</code><a class="headerlink" href="#mbgdml.calculate.CalcTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Contains all quantum chemistry calculations templates for mako.</p>
</dd></dl>

<dl class="class">
<dt id="mbgdml.calculate.ORCA">
<em class="property">class </em><code class="descclassname">mbgdml.calculate.</code><code class="descname">ORCA</code><a class="headerlink" href="#mbgdml.calculate.ORCA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Prepares, writes, and submits ORCA 4.2.0 calculations.</p>
<dl class="method">
<dt id="mbgdml.calculate.ORCA.input_corrections">
<code class="descname">input_corrections</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.ORCA.input_corrections" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mbgdml.calculate.ORCA.write_input">
<code class="descname">write_input</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.ORCA.write_input" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="mbgdml.calculate.ORCA.write_submit">
<code class="descname">write_submit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.ORCA.write_submit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="mbgdml.calculate.mbGDMLCalculator">
<em class="property">class </em><code class="descclassname">mbgdml.calculate.</code><code class="descname">mbGDMLCalculator</code><span class="sig-paren">(</span><em>elements</em>, <em>model_paths</em>, <em>e_unit_model='kcal/mol'</em>, <em>r_unit_model='Angstrom'</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ase.calculators.calculator.Calculator</span></code></p>
<p>Initializes mbGDML calculator with models and units.</p>
<dl class="docutils">
<dt>model_paths <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Paths of all models to be used for GDML prediction.</dd>
<dt>e_unit_model <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>Specifies the units of energy prediction for the GDML models. Defaults
to ‘kcal/mol’.</dd>
<dt>r_unit_model <span class="classifier-delimiter">:</span> <span class="classifier">str, optional</span></dt>
<dd>Specifies the distance units for GDML models. Defaults to ‘Angstrom’.</dd>
</dl>
<dl class="method">
<dt id="mbgdml.calculate.mbGDMLCalculator.load_models">
<code class="descname">load_models</code><span class="sig-paren">(</span><em>model_paths</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator.load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads models for GDML prediction.</p>
</dd></dl>

<dl class="method">
<dt id="mbgdml.calculate.mbGDMLCalculator.calculate">
<code class="descname">calculate</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator.calculate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">calculate</code><span class="sig-paren">(</span><em>atoms=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Predicts energy and forces using many-body GDML models.</p>
</dd></dl>

<dl class="attribute">
<dt id="mbgdml.calculate.mbGDMLCalculator.implemented_properties">
<code class="descname">implemented_properties</code><em class="property"> = ['energy', 'forces']</em><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator.implemented_properties" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="descname">load_models</code><span class="sig-paren">(</span><em>model_paths</em><span class="sig-paren">)</span></dt>
<dd><p>Loads models for GDML prediction.</p>
<dl class="docutils">
<dt>model_paths <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Contains paths of all GDML models to be loaded. All of these models
will be used during the MD run.</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mbgdml.calculate.mbGDMLMD">
<em class="property">class </em><code class="descclassname">mbgdml.calculate.</code><code class="descname">mbGDMLMD</code><span class="sig-paren">(</span><em>structure_name</em>, <em>structure_path</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mbgdml.data.html#mbgdml.data.basedata.mbGDMLData" title="mbgdml.data.basedata.mbGDMLData"><code class="xref py py-class docutils literal notranslate"><span class="pre">mbgdml.data.basedata.mbGDMLData</span></code></a></p>
<p>Molecular dynamics through ASE with many-body GDML models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structure_name</strong> (<em>str</em>) – Name of the structure. Mainly for file naming.</li>
<li><strong>structure_path</strong> (<em>str</em>) – Path to the structure file.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="mbgdml.calculate.mbGDMLMD.load_calculator">
<code class="descname">load_calculator</code><span class="sig-paren">(</span><em>model_paths</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.load_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the many-body GDML ASE calculator.</p>
<dl class="docutils">
<dt>model_paths <span class="classifier-delimiter">:</span> <span class="classifier">list</span></dt>
<dd>Paths to all many-body GDML models to be used.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mbgdml.calculate.mbGDMLMD.printenergy">
<code class="descname">printenergy</code><span class="sig-paren">(</span><em>a</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.printenergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick function to print MD information during simulation.</p>
<dl class="docutils">
<dt>a <span class="classifier-delimiter">:</span> <span class="classifier"><cite>ase.atoms</cite></span></dt>
<dd>Atoms object from ASE.</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mbgdml.calculate.mbGDMLMD.relax">
<code class="descname">relax</code><span class="sig-paren">(</span><em>max_force=0.0001</em>, <em>steps=100</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.relax" title="Permalink to this definition">¶</a></dt>
<dd><p>Short relaxation of structure.</p>
<dl class="docutils">
<dt>max_force <span class="classifier-delimiter">:</span> <span class="classifier">float, optional</span></dt>
<dd>Maximum force. Defaults to 1e-4.</dd>
<dt>steps <span class="classifier-delimiter">:</span> <span class="classifier">int, optional</span></dt>
<dd>Maximum allowable steps. Defaults to 100.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code> – Requires a calculator to be loaded first.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbgdml.calculate.mbGDMLMD.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>steps</em>, <em>t_step</em>, <em>temp</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a MD simulation using the Verlet algorithm in ASE.</p>
<dl class="docutils">
<dt>steps <span class="classifier-delimiter">:</span> <span class="classifier"><cite>int</cite></span></dt>
<dd>Number of steps for the MD simulation.</dd>
<dt>t_step <span class="classifier-delimiter">:</span> <span class="classifier"><cite>float</cite></span></dt>
<dd>Time step in femtoseconds.</dd>
<dt>temp <span class="classifier-delimiter">:</span> <span class="classifier"><cite>float</cite></span></dt>
<dd>Temperature in Kelvin used for initializing velocities.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><code class="xref py py-exc docutils literal notranslate"><span class="pre">AttributeError</span></code> – Requires a calculator to be loaded first.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mbgdml.calculate.partition_engrad">
<code class="descclassname">mbgdml.calculate.</code><code class="descname">partition_engrad</code><span class="sig-paren">(</span><em>package</em>, <em>partition_dict</em>, <em>temperature</em>, <em>md_iteration</em>, <em>calc_dir='.'</em>, <em>calc_name='partition-engrad'</em>, <em>theory_level_engrad='MP2'</em>, <em>basis_set_engrad='def2-TZVP'</em>, <em>options_engrad='TightSCF FrozenCore'</em>, <em>control_blocks_engrad='%scf\n    ConvForced true\nend\n%maxcore 8000\n'</em>, <em>submit=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.calculate.partition_engrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up a partition ORCA 4.2.0 EnGrad calculation for trajectory.</p>
<p>Can be submitted or just have the input files prepared.</p>
<dl class="docutils">
<dt>package <span class="classifier-delimiter">:</span> <span class="classifier"><cite>str</cite></span></dt>
<dd>Specifies the quantum chemistry program to be used. ORCA is currently
the only package directly supported.</dd>
<dt>partition_dict <span class="classifier-delimiter">:</span> <span class="classifier"><cite>dict</cite></span></dt>
<dd>Contains all information for the partition including ‘solvent_label’,
‘partition_size’, ‘atoms’, and ‘coords’.</dd>
<dt>temperature <span class="classifier-delimiter">:</span> <span class="classifier"><cite>int</cite></span></dt>
<dd>Used for labeling and identifying the thermostat temperature for the
molecular dynamics simulation.</dd>
<dt>md_iteration <span class="classifier-delimiter">:</span> <span class="classifier"><cite>int</cite></span></dt>
<dd>Used for labeling and identifying the iteration of the molecular
dynamics simulation.</dd>
<dt>calc_dir <span class="classifier-delimiter">:</span> <span class="classifier"><cite>str</cite>, optional</span></dt>
<dd>Path to write calculation. Defaults to current directory (‘./’).</dd>
<dt>calc_name <span class="classifier-delimiter">:</span> <span class="classifier"><cite>str</cite>, optional</span></dt>
<dd>Name for the calculation. Defaults to ‘partition-engrad’.</dd>
<dt>theory_level_engrad <span class="classifier-delimiter">:</span> <span class="classifier"><cite>str</cite>, optional</span></dt>
<dd>Keword that specifies the level of theory (e.g., MP2, BP86, B3LYP,
etc.) used for calculations. Defaults to ‘MP2’ for ORCA 4.2.0.</dd>
<dt>basis_set_engrad <span class="classifier-delimiter">:</span> <span class="classifier"><cite>str</cite>, optional</span></dt>
<dd>Keyword that specifies the basis set (e.g., def2-SVP, def2-TZVP, etc.).
Defaults to ‘def2-TZVP’.</dd>
<dt>options_engrad <span class="classifier-delimiter">:</span> <span class="classifier"><cite>str</cite>, optional</span></dt>
<dd>All options specifically for the EnGrad calculation (e.g., SCF
convergence criteria, algorithms, etc.) Defaults to ‘TightSCF
FrozenCore’.</dd>
<dt>control_blocks_engrad <span class="classifier-delimiter">:</span> <span class="classifier"><cite>str</cite>, optional</span></dt>
<dd>All options that control the calculation. Defaults to
‘%scf    ConvForced true end’.</dd>
<dt>submit <span class="classifier-delimiter">:</span> <span class="classifier"><cite>bool</cite>, optional</span></dt>
<dd>Controls whether the calculation is submitted. Defaults to False.</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">calculate</span><span class="o">.</span><span class="n">partition_engrad</span><span class="p">(</span><span class="s1">&#39;orca&#39;</span><span class="p">,</span> <span class="s1">&#39;/path/to/dir/&#39;</span><span class="p">,</span> <span class="n">partition_dict</span><span class="p">,</span>
<span class="go">temp, iteration)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-mbgdml.cli">
<span id="mbgdml-cli-module"></span><h2>mbgdml.cli module<a class="headerlink" href="#module-mbgdml.cli" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mbgdml.parse">
<span id="mbgdml-parse-module"></span><h2>mbgdml.parse module<a class="headerlink" href="#module-mbgdml.parse" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mbgdml.parse.cluster_size">
<code class="descclassname">mbgdml.parse.</code><code class="descname">cluster_size</code><span class="sig-paren">(</span><em>xyz_path</em>, <em>solvent</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.parse.cluster_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines number of solvent molecules in a xyz file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xyz_path</strong> (<em>str</em>) – Path to xyz file of interest.</li>
<li><strong>solvent</strong> (<em>lst</em>) – Specifies solvents to determine the number of atoms included in a
molecule.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Number of solvent molecules in specified xyz file.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">int</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.parse.parse_cluster">
<code class="descclassname">mbgdml.parse.</code><code class="descname">parse_cluster</code><span class="sig-paren">(</span><em>cluster_data</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.parse.parse_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates dictionary of all solvent molecules in solvent cluster from a
cluster_data dictionary.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cluster_data</strong> (<em>dict</em>) – Contains ‘atoms’ that is a list of elements organized by molecule and
matches the order of the numpy array containing atomic coordinates</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Contains solvent molecules with keys of uppercase characters with dicts
as values containing ‘atoms’ and ‘coords’.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Molecules are specified by specified by uppercase letters, and their
values the xyz coordinates.</p>
<p class="rubric">Examples</p>
<dl class="docutils">
<dt>{</dt>
<dd><dl class="first docutils">
<dt>‘A’: {</dt>
<dd><p class="first">‘atoms’:   array([8, 1, 6, 1, 1, 1], dtype=int32),
‘coords’:  array([[ 1.45505901, -0.880818  ,  0.851331  ],</p>
<blockquote class="last">
<div>[ 0.505216  , -1.15252401,  0.844885  ],
[ 2.22036801, -1.94217701,  0.2977    ],
[ 3.25924901, -1.61877101,  0.264909  ],
[ 1.89693001, -2.18833701, -0.717112  ],
[ 2.15446301, -2.84056201,  0.915723  ]])</div></blockquote>
</dd>
</dl>
<p>},
‘B’: {</p>
<blockquote>
<div><p>‘atoms’:   array([8, 1, 6, 1, 1, 1], dtype=int32),
‘coords’:  array([[ 1.14600801,  1.44243601, -0.473102  ],</p>
<blockquote>
<div>[ 1.38561801,  0.614295  ,  0.00943   ],
[ 1.47489701,  2.54700101,  0.357836  ],
[ 1.16626501,  3.45362102, -0.159587  ],
[ 2.55100901,  2.59826701,  0.538796  ],
[ 0.957941  ,  2.49831901,  1.31983201]])</div></blockquote>
</div></blockquote>
<p class="last">}</p>
</dd>
</dl>
<p>}</p>
</dd></dl>

<dl class="function">
<dt id="mbgdml.parse.parse_coords">
<code class="descclassname">mbgdml.parse.</code><code class="descname">parse_coords</code><span class="sig-paren">(</span><em>fileName</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.parse.parse_coords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="mbgdml.parse.parse_gdml_data">
<code class="descclassname">mbgdml.parse.</code><code class="descname">parse_gdml_data</code><span class="sig-paren">(</span><em>out_file</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.parse.parse_gdml_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses GDML-relevant data from partition output file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>out_file</strong> (<em>str</em>) – Path to computational chemistry output file. This should contain all MD
steps for the partition.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Contains all information needed to build GDML data sets. ‘atoms’ is a
(n) numpy array containing the atomic numbers of the atoms in the
partition. ‘coords’ is a (m, n, 3) numpy array containing the m MD
step coordinates of the n atoms in the partition. ‘grads’ is a
(m, n, 3) numpy array containing the gradients of the m MD steps
containing the n atoms in the partition. ‘energies’ is a (m, 1) numpy
array containing the electronic energies of each m MD steps for the
partition.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.parse.parse_stringfile">
<code class="descclassname">mbgdml.parse.</code><code class="descname">parse_stringfile</code><span class="sig-paren">(</span><em>stringfile_path</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.parse.parse_stringfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses xyz stringfile into <a href="#id1"><span class="problematic" id="id2">**</span></a><a href="#id3"><span class="problematic" id="id4">*</span></a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>stringfile_path</strong> (<em>str</em>) – Specifies path to stringfile.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">TODO</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.parse.struct_dict">
<code class="descclassname">mbgdml.parse.</code><code class="descname">struct_dict</code><span class="sig-paren">(</span><em>origin</em>, <em>struct_list</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.parse.struct_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mbgdml.partition">
<span id="mbgdml-partition-module"></span><h2>mbgdml.partition module<a class="headerlink" href="#module-mbgdml.partition" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mbgdml.partition.partition_cluster">
<code class="descclassname">mbgdml.partition.</code><code class="descname">partition_cluster</code><span class="sig-paren">(</span><em>cluster</em>, <em>nbody</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.partition.partition_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates dictionary with all possible n-body combinations of solvent
cluster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cluster</strong> (<em>dict</em>) – Dictionary of solvent molecules in cluster from parse_cluster</li>
<li><strong>nbody</strong> (<em>int</em>) – Desired number of solvent molecules in combination.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">All nonrepeating solvent molecule combinations from cluster with keys
being uppercase concatenations of molecule labels and values being the
string of coordinates.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>ABC is considered the same as BAC and only included once.</p>
</dd></dl>

<dl class="function">
<dt id="mbgdml.partition.partition_trajectory">
<code class="descclassname">mbgdml.partition.</code><code class="descname">partition_trajectory</code><span class="sig-paren">(</span><em>traj_path</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.partition.partition_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>Partitions MD trajectory into separate trajectories for each possible
segment.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>traj_path</strong> (<em>str</em>) – Path to trajectory with xyz coordinates.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">All nonrepeating solvent molecule combinations from cluster with keys
being uppercase concatenations of molecule labels and values being the
string of coordinates.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mbgdml.predict">
<span id="mbgdml-predict-module"></span><h2>mbgdml.predict module<a class="headerlink" href="#module-mbgdml.predict" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mbgdml.predict.mbGDMLPredict">
<em class="property">class </em><code class="descclassname">mbgdml.predict.</code><code class="descname">mbGDMLPredict</code><span class="sig-paren">(</span><em>models</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="mbgdml.predict.mbGDMLPredict.decomposed_predict">
<code class="descname">decomposed_predict</code><span class="sig-paren">(</span><em>z</em>, <em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict.decomposed_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes predicted total energy and atomic forces decomposed by
many body order.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>list</em>) – Atomic numbers of all atoms in the system.</li>
<li><strong>R</strong> (<em>numpy.ndarray</em>) – Cartesian coordinates of all atoms of the structure specified in
the same order as z. The array should have shape (n, 3) where n is
the number of atoms.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Dictionaries of many-body contributions of total energies
(float) and forces (np.ndarray) of the structure. Note that
forces has the same shape as R. Each key of the dictionary is
the order of the many-body model. Within this dictionary is a
total, ‘T’, and molecule combinations identified in the system
and their contributions.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">1.530147</span><span class="p">,</span>  <span class="mf">1.121901</span><span class="p">,</span>  <span class="mf">0.396232</span><span class="p">],</span>
<span class="go">                    [ 2.350485,  1.1297  , -0.085235],</span>
<span class="go">                    [ 0.823842,  1.311077, -0.2846  ],</span>
<span class="go">                    [-1.464849, -1.155867, -0.449863],</span>
<span class="go">                    [-1.41447 , -1.99605 , -0.917981],</span>
<span class="go">                    [-0.868584, -1.275659,  0.32329 ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E_predicted</span><span class="p">,</span> <span class="n">F_predicted</span> <span class="o">=</span> <span class="n">decomposed_predict</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E_predicted</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>  <span class="c1"># Units here are kcal/mol</span>
<span class="go">-95775.24328734782</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F_predicted</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>  <span class="c1"># Units here are kcal/(mol A)</span>
<span class="go">array([[-4.06668790e+01,  5.97564871e+00, -1.63273803e+01],</span>
<span class="go">       [ 1.10787347e+01,  6.38884805e-01, -9.01790818e+00],</span>
<span class="go">       [ 2.82554119e+01, -8.11473944e+00,  2.53684238e+01],</span>
<span class="go">       [ 1.45845554e+01, -2.53514310e+00,  1.76065017e+01],</span>
<span class="go">       [-3.53967582e-02,  2.91676403e-01,  2.61011071e-01],</span>
<span class="go">       [-1.32164262e+01,  3.74366076e+00, -1.78906481e+01]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mbgdml.predict.mbGDMLPredict.predict">
<code class="descname">predict</code><span class="sig-paren">(</span><em>z</em>, <em>R</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts total energy and atomic forces using many-body GDML models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<em>list</em>) – Atomic numbers of all atoms in the system.</li>
<li><strong>R</strong> (<em>numpy.ndarray</em>) – Cartesian coordinates of all atoms of the structure specified in
the same order as z. The array should have shape (n, 3) where n is
the number of atoms.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Total energy of the system (float) and atomic forces (numpy.ndarray)
in the units specified by the GDML models. Note that the forces
have the same shape as R.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">tuple</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbgdml.predict.mbGDMLPredict.remove_nbody">
<code class="descname">remove_nbody</code><span class="sig-paren">(</span><em>dataset</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict.remove_nbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates GDML dataset with GDML predicted n-body predictions
removed.</p>
<p>To employ the many body expansion, we need GDML models that predict
n-body corrections/contributions. This provides the appropriate dataset
for training an (n+1)-body mbGDML model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>base_vars</strong> (<em>dict</em>) – GDML dataset converted to a dict containing n-body contributions to
be removed.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mbgdml.solvents">
<span id="mbgdml-solvents-module"></span><h2>mbgdml.solvents module<a class="headerlink" href="#module-mbgdml.solvents" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mbgdml.solvents.solvent">
<em class="property">class </em><code class="descclassname">mbgdml.solvents.</code><code class="descname">solvent</code><span class="sig-paren">(</span><em>atom_list</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.solvents.solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Identifies and describes the solvent for MB-GDML.</p>
<p>Represents the solvent that makes up the cluster MB-GDML is being trained
from.</p>
<dl class="attribute">
<dt id="mbgdml.solvents.solvent.system">
<code class="descname">system</code><a class="headerlink" href="#mbgdml.solvents.solvent.system" title="Permalink to this definition">¶</a></dt>
<dd><p>Designates what kind of system this is. Currently only ‘solvent’
systems.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbgdml.solvents.solvent.solvent_name">
<code class="descname">solvent_name</code><a class="headerlink" href="#mbgdml.solvents.solvent.solvent_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the solvent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbgdml.solvents.solvent.solvent_label">
<code class="descname">solvent_label</code><a class="headerlink" href="#mbgdml.solvents.solvent.solvent_label" title="Permalink to this definition">¶</a></dt>
<dd><p>A label for the solvent for filenaming purposes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbgdml.solvents.solvent.solvent_molec_size">
<code class="descname">solvent_molec_size</code><a class="headerlink" href="#mbgdml.solvents.solvent.solvent_molec_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of atoms in one solvent molecule.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="mbgdml.solvents.solvent.cluster_size">
<code class="descname">cluster_size</code><a class="headerlink" href="#mbgdml.solvents.solvent.cluster_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of solvent molecules in cluster.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbgdml.solvents.solvent.atom_numbers">
<code class="descname">atom_numbers</code><span class="sig-paren">(</span><em>chem_formula</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.solvents.solvent.atom_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a dictionary of atoms and their quantity from chemical
formula.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>chem_formula</strong> (<em>str</em>) – The chemical formula of a single solvent  molecule. For example,
‘CH3OH’ for methanol, ‘H2O’ for water, and ‘C2H3N’ for acetonitrile.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Contains the atoms as their elemental symbol for keys and their
quantity as values.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atom_numbers</span><span class="p">(</span><span class="s1">&#39;CH3OH&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mbgdml.solvents.solvent.identify_solvent">
<code class="descname">identify_solvent</code><span class="sig-paren">(</span><em>atom_list</em>, <em>all_solvents</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.solvents.solvent.identify_solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the solvent from a repeated list of elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>atom_list</strong> (<em>list</em>) – Elements as strings. Elements should be repeated. For example,
[‘H’, ‘H’, ‘O’, ‘O’, ‘H’, ‘H’]. Note that the order does not
matter; only the quantity.</li>
<li><strong>all_solvents</strong> (<em>dict</em>) – Contains all solvents described in solvents.json. Keys are the name
of the solvent, and the values are dicts ‘label’ and ‘formula’ that
provide a solvent label and chemical formula, respectively.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mbgdml.solvents.system_info">
<code class="descclassname">mbgdml.solvents.</code><code class="descname">system_info</code><span class="sig-paren">(</span><em>atoms</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.solvents.system_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines information about the system key to mbGDML.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atoms</strong> (<em>list</em>) – Atomic numbers of all atoms in the system.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">System information useful for mbGDML. Information includes ‘system’
which categorizes the system and provides specific information.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>For a ‘solvent’ system the additional information returned is the
‘solvent_name’, ‘solvent_label’, ‘solvent_molec_size’, and ‘cluster_size’.</p>
</dd></dl>

</div>
<div class="section" id="module-mbgdml.train">
<span id="mbgdml-train-module"></span><h2>mbgdml.train module<a class="headerlink" href="#module-mbgdml.train" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mbgdml.train.MBGDMLTrain">
<em class="property">class </em><code class="descclassname">mbgdml.train.</code><code class="descname">MBGDMLTrain</code><a class="headerlink" href="#mbgdml.train.MBGDMLTrain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="mbgdml.train.MBGDMLTrain.load_dataset">
<code class="descname">load_dataset</code><span class="sig-paren">(</span><em>dataset_path</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.train.MBGDMLTrain.load_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a GDML dataset from npz format from specified path.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>dataset_path</strong> (<em>str</em>) – Path to stored numpy arrays representing a GDML dataset of a single
solvent partition size.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="mbgdml.train.MBGDMLTrain.train_GDML">
<code class="descname">train_GDML</code><span class="sig-paren">(</span><em>model_dir</em>, <em>num_train</em>, <em>num_validate</em>, <em>num_test</em>, <em>sigma_range='2:10:100'</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.train.MBGDMLTrain.train_GDML" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a GDML model through the command line interface.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>model_dir</strong> (<em>str</em>) – Path to a common directory for GDML models.</li>
<li><strong>num_train</strong> (<em>int</em>) – The number of training points to sample.</li>
<li><strong>num_validate</strong> (<em>int</em>) – The number of validation points to sample, without replacement.</li>
<li><strong>num_test</strong> (<em>int</em>) – The number of test points to test the validated GDML model.</li>
<li><strong>sigma_range</strong> (<em>str</em><em>, </em><em>optional</em>) – Range of kernel length scales to train and validate GDML values
one. Format is <cite>&lt;start&gt;:&lt;interval&gt;:&lt;stop&gt;</cite>. Note, the more length
scales the longer the training time. Two is the minimum value.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mbgdml.utils">
<span id="mbgdml-utils-module"></span><h2>mbgdml.utils module<a class="headerlink" href="#module-mbgdml.utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="mbgdml.utils.atoms_by_element">
<code class="descclassname">mbgdml.utils.</code><code class="descname">atoms_by_element</code><span class="sig-paren">(</span><em>atom_list</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.utils.atoms_by_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a list of atoms identified by their atomic number to their
elemental symbol.</p>
<p>Parameters
atom_list : list</p>
<blockquote>
<div>Contains numbers that represent atomic numbers.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Contains strings of elemental symbols matching atom_list.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.utils.convert_forces">
<code class="descclassname">mbgdml.utils.</code><code class="descname">convert_forces</code><span class="sig-paren">(</span><em>package</em>, <em>forces</em>, <em>e_units</em>, <em>r_units</em>, <em>e_units_calc=None</em>, <em>r_units_calc=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.utils.convert_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts forces (or gradients) to specified units.</p>
<p>cclib automatically converts energy units to eV, but does not convert
gradients. GDML needs consistent energy and force units, so we convert
them.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>package</strong> (<em>str</em>) – Computational chemistry package used for computations.</li>
<li><strong>forces</strong> (<em>numpy.ndarray</em>) – An array with units of energy and distance matching <cite>e_units_calc</cite>
and <cite>r_units_calc</cite>.</li>
<li><strong>e_units</strong> (<em>str</em>) – Desired units of energy. Available units are ‘eV’, ‘hartree’,
‘kcal/mol’, and ‘kJ/mol’.</li>
<li><strong>r_units</strong> (<em>str</em>) – Desired units of distance. Available units implemented in cclib’s
convertor function are ‘Angstrom’ and ‘bohr’.</li>
<li><strong>e_units_calc</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies package-specific energy units used in calculation.
Defaults to None.</li>
<li><strong>r_units_calc</strong> (<em>str</em><em>, </em><em>optional</em>) – Specifies package-specific distance units used in calculation.
Defaults to None.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – If the selected energy units are not implemented.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – If the selected distance units are not implemented.</li>
<li><code class="xref py py-exc docutils literal notranslate"><span class="pre">ValueError</span></code> – If calculation package is not defined here for known energy and
distance units.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Only supports ‘ORCA’ for automatically determining calc units.
Otherwise, manually specify <cite>e_units_calc</cite> and <cite>r_units_calc</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="mbgdml.utils.get_files">
<code class="descclassname">mbgdml.utils.</code><code class="descname">get_files</code><span class="sig-paren">(</span><em>path</em>, <em>expression</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.utils.get_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns paths to all files in a given directory that matches a provided
expression in the file name. Commonly used to find all files of a certain
type, e.g. output or xyz files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong> (<em>str</em>) – Specifies the directory to search.</li>
<li><strong>expression</strong> (<em>str</em>) – Expression to be tested against all file names in ‘path’.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">all absolute paths to files matching the provided expression.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">list</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.utils.make_folder">
<code class="descclassname">mbgdml.utils.</code><code class="descname">make_folder</code><span class="sig-paren">(</span><em>folder</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.utils.make_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates folder at specified path.
If the current folder exists, it creates another folder
with an added number.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pathFolder</strong> (<em>str</em>) – Path to desired folder.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Final path of new folder; ends in ‘/’.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.utils.natsort_list">
<code class="descclassname">mbgdml.utils.</code><code class="descname">natsort_list</code><span class="sig-paren">(</span><em>unsorted_list</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.utils.natsort_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic function that organizes a list based on human (or natural) sorting
methodology.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>unsorted_list</strong> (<em>list</em>) – List of strings.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Sorted list of string.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">list</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.utils.norm_path">
<code class="descclassname">mbgdml.utils.</code><code class="descname">norm_path</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.utils.norm_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes directory paths to be consistent.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> (<em>str</em>) – Path to a directory.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Normalized path.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="mbgdml.utils.string_coords">
<code class="descclassname">mbgdml.utils.</code><code class="descname">string_coords</code><span class="sig-paren">(</span><em>atoms</em>, <em>coords</em><span class="sig-paren">)</span><a class="headerlink" href="#mbgdml.utils.string_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Puts atomic coordinates into a Python string. Typically used for
writing to an input file.</p>
<p>Parameters
atoms : numpy.ndarray</p>
<blockquote>
<div>A (n, 1) numpy array containing all n elements labled by their atomic
number.</div></blockquote>
<dl class="docutils">
<dt>coords <span class="classifier-delimiter">:</span> <span class="classifier">numpy.array</span></dt>
<dd>Contains atomic positions in a (n, 3) numpy array where the x, y, and z
Cartesian coordinates in Angstroms are given for the n atoms.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">all atomic coordinates contained in a string.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-mbgdml">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mbgdml" title="Permalink to this headline">¶</a></h2>
<p>Top-level package for mbgdml.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mbgdml.analysis.html" class="btn btn-neutral float-right" title="mbgdml.analysis package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modules.html" class="btn btn-neutral float-left" title="mbgdml" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Alex M. Maldonado

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>