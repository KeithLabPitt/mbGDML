

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>mbgdml package &mdash; mbGDML  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mbgdml.analysis package" href="mbgdml.analysis.html" />
    <link rel="prev" title="mbgdml" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> mbGDML
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/tutorials.html">Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">API</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">mbgdml package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="mbgdml.analysis.html">mbgdml.analysis package</a></li>
<li class="toctree-l4"><a class="reference internal" href="mbgdml.data.html">mbgdml.data package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.calculate">mbgdml.calculate module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.parse">mbgdml.parse module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.partition">mbgdml.partition module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.predict">mbgdml.predict module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.solvents">mbgdml.solvents module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.train">mbgdml.train module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml.utils">mbgdml.utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-mbgdml">Module contents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">mbGDML</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">mbgdml</a> &raquo;</li>
        
      <li>mbgdml package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/doc/mbgdml.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mbgdml-package">
<h1>mbgdml package<a class="headerlink" href="#mbgdml-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="mbgdml.analysis.html">mbgdml.analysis package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#module-mbgdml.analysis.nbody">mbgdml.analysis.nbody module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#module-mbgdml.analysis.similarity">mbgdml.analysis.similarity module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.analysis.html#module-mbgdml.analysis">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mbgdml.data.html">mbgdml.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.basedata">mbgdml.data.basedata module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.calculation">mbgdml.data.calculation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.dataset">mbgdml.data.dataset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.generate">mbgdml.data.generate module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.model">mbgdml.data.model module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.predictset">mbgdml.data.predictset module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data.structure">mbgdml.data.structure module</a></li>
<li class="toctree-l2"><a class="reference internal" href="mbgdml.data.html#module-mbgdml.data">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mbgdml.calculate">
<span id="mbgdml-calculate-module"></span><h2>mbgdml.calculate module<a class="headerlink" href="#module-mbgdml.calculate" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mbgdml.calculate.CalcTemplate">
<em class="property">class </em><code class="sig-prename descclassname">mbgdml.calculate.</code><code class="sig-name descname">CalcTemplate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">package</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#CalcTemplate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.CalcTemplate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Contains all quantum chemistry templates for mako.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>package</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Computational chemistry package to perform calculations.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="mbgdml.calculate.ORCA">
<em class="property">class </em><code class="sig-prename descclassname">mbgdml.calculate.</code><code class="sig-name descname">ORCA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">job_name</span></em>, <em class="sig-param"><span class="n">input_name</span></em>, <em class="sig-param"><span class="n">output_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#ORCA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.ORCA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Prepares, writes, and submits ORCA 4 calculations.</p>
<dl class="py method">
<dt id="mbgdml.calculate.ORCA.input">
<code class="sig-name descname">input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">calc_type</span></em>, <em class="sig-param"><span class="n">coords</span></em>, <em class="sig-param"><span class="n">theory</span></em>, <em class="sig-param"><span class="n">basis_set</span></em>, <em class="sig-param"><span class="n">charge</span></em>, <em class="sig-param"><span class="n">multiplicity</span></em>, <em class="sig-param"><span class="n">cores</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">control_blocks</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">write</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">write_dir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">input_extension</span><span class="o">=</span><span class="default_value">'inp'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#ORCA.input"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.ORCA.input" title="Permalink to this definition">¶</a></dt>
<dd><p>Rendered input file as string.</p>
<blockquote>
<div><dl>
<dt>calc_type<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>Type of calculation. Options are <code class="docutils literal notranslate"><span class="pre">'SP'</span></code>, <code class="docutils literal notranslate"><span class="pre">'ENGRAD'</span></code>, <code class="docutils literal notranslate"><span class="pre">'OPT'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'FREQ'</span></code>, <code class="docutils literal notranslate"><span class="pre">'NUMFREQ'</span></code>. Note that analytical frequency
calculation is called with <code class="docutils literal notranslate"><span class="pre">'FREQ'</span></code>.</p>
</dd>
<dt>coords<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>XYZ atomic coordinates as a string. A water molecule for example,
<a href="#id1"><span class="problematic" id="id2">``</span></a>’O          0.00000        0.00000        0.11779</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>H</dt><dd><p>0.00000        0.75545       -0.47116</p>
</dd>
<dt>H          0.00000</dt><dd><blockquote>
<div><blockquote>
<div><p>-0.75545       -0.47116’<a href="#id3"><span class="problematic" id="id4">``</span></a>.</p>
</div></blockquote>
<dl>
<dt>theory<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The level of theory for the calculations. For example, <code class="docutils literal notranslate"><span class="pre">'B3LYP'</span></code>
or <code class="docutils literal notranslate"><span class="pre">'MP2'</span></code>.</p>
</dd>
<dt>basis_set<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The basis set to be used in the calculations. For example,
<code class="docutils literal notranslate"><span class="pre">'def2-TZVP'</span></code>.</p>
</dd>
<dt>charge<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>System charge.</p>
</dd>
<dt>multiplicity<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>System multiplicity.</p>
</dd>
<dt>cores<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>Number of requested cores per node.</p>
</dd>
<dt>options<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>Other calculations options such as implicit solvents, convergence
criteria, etc. For example, <code class="docutils literal notranslate"><span class="pre">'CPCM(water)</span> <span class="pre">Grid4</span> <span class="pre">TightSCF'</span></code>.</p>
</dd>
<dt>control_blocks<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>All options that control the calculation. For example
<a href="#id5"><span class="problematic" id="id6">``</span></a>’%scf</p>
</dd>
</dl>
</div></blockquote>
<p>ConvForced true</p>
</dd>
</dl>
<p>end
%maxcore 8000
‘<a href="#id7"><span class="problematic" id="id8">``</span></a>.</p>
<blockquote>
<div><dl>
<dt>write<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional</span></dt><dd><p>Whether or not to write the file. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
</dd>
<dt>write_dir<span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>Directory to write the input file. Defaults to <code class="docutils literal notranslate"><span class="pre">'.'</span></code></p>
</dd>
<dt>input_extension: <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional</dt><dd><p>File extension for ORCA input. Defaults to <code class="docutils literal notranslate"><span class="pre">'inp'</span></code>.</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.calculate.ORCA.input_check">
<code class="sig-name descname">input_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#ORCA.input_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.ORCA.input_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs checks on input specifications.</p>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.calculate.ORCA.submit">
<code class="sig-name descname">submit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cluster</span></em>, <em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">cores</span></em>, <em class="sig-param"><span class="n">days</span></em>, <em class="sig-param"><span class="n">hours</span></em>, <em class="sig-param"><span class="n">submit_script</span></em>, <em class="sig-param"><span class="n">write</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">write_dir</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#ORCA.submit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.ORCA.submit" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepare submission script.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of cluster for calculations. For example, <code class="docutils literal notranslate"><span class="pre">'smp'</span></code>.</p></li>
<li><p><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of requested nodes.</p></li>
<li><p><strong>cores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of requested cores per node.</p></li>
<li><p><strong>days</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Requested run time days.</p></li>
<li><p><strong>hours</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Requested run time hours.</p></li>
<li><p><strong>write</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Whether or not to write the file. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>write_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Directory to write the input file. Defaults to <code class="docutils literal notranslate"><span class="pre">'.'</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> – File name (with extension) of the submission script.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> – Rendered submission script.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mbgdml.calculate.mbGDMLCalculator">
<em class="property">class </em><code class="sig-prename descclassname">mbgdml.calculate.</code><code class="sig-name descname">mbGDMLCalculator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">elements</span></em>, <em class="sig-param"><span class="n">model_paths</span></em>, <em class="sig-param"><span class="n">e_unit_model</span><span class="o">=</span><span class="default_value">'kcal/mol'</span></em>, <em class="sig-param"><span class="n">r_unit_model</span><span class="o">=</span><span class="default_value">'Angstrom'</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLCalculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">ase.calculators.calculator.Calculator</span></code></p>
<p>Initializes mbGDML calculator with models and units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_paths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>) – Paths of all models to be used for GDML prediction.</p></li>
<li><p><strong>e_unit_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Specifies the units of energy prediction for the GDML models. Defaults
to ‘kcal/mol’.</p></li>
<li><p><strong>r_unit_model</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Specifies the distance units for GDML models. Defaults to ‘Angstrom’.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="mbgdml.calculate.mbGDMLCalculator.calculate">
<code class="sig-name descname">calculate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLCalculator.calculate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator.calculate" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts energy and forces using many-body GDML models.</p>
</dd></dl>

<dl class="py attribute">
<dt id="mbgdml.calculate.mbGDMLCalculator.implemented_properties">
<code class="sig-name descname">implemented_properties</code><em class="property">: List<span class="p">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a><span class="p">]</span></em><em class="property"> = ['energy', 'forces']</em><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator.implemented_properties" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="mbgdml.calculate.mbGDMLCalculator.load_models">
<code class="sig-name descname">load_models</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_paths</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLCalculator.load_models"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLCalculator.load_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads models for GDML prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_paths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>]) – Contains paths of all GDML models to be loaded. All of these models
will be used during the MD run.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="mbgdml.calculate.mbGDMLMD">
<em class="property">class </em><code class="sig-prename descclassname">mbgdml.calculate.</code><code class="sig-name descname">mbGDMLMD</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">structure_name</span></em>, <em class="sig-param"><span class="n">structure_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLMD"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="mbgdml.data.html#mbgdml.data.basedata.mbGDMLData" title="mbgdml.data.basedata.mbGDMLData"><code class="xref py py-class docutils literal notranslate"><span class="pre">mbgdml.data.basedata.mbGDMLData</span></code></a></p>
<p>Molecular dynamics through ASE with many-body GDML models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the structure. Mainly for file naming.</p></li>
<li><p><strong>structure_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to the structure file.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="mbgdml.calculate.mbGDMLMD.load_calculator">
<code class="sig-name descname">load_calculator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_paths</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLMD.load_calculator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.load_calculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads the many-body GDML ASE calculator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model_paths</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>) – Paths to all many-body GDML models to be used.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.calculate.mbGDMLMD.printenergy">
<code class="sig-name descname">printenergy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">a</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLMD.printenergy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.printenergy" title="Permalink to this definition">¶</a></dt>
<dd><p>Quick function to print MD information during simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">ase.atoms</span></code>) – Atoms object from ASE.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.calculate.mbGDMLMD.relax">
<code class="sig-name descname">relax</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">max_force</span><span class="o">=</span><span class="default_value">0.0001</span></em>, <em class="sig-param"><span class="n">steps</span><span class="o">=</span><span class="default_value">100</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLMD.relax"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.relax" title="Permalink to this definition">¶</a></dt>
<dd><p>Short relaxation of structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_force</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>, optional) – Maximum force. Defaults to <code class="docutils literal notranslate"><span class="pre">1e-4</span></code>.</p></li>
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Maximum allowable steps. Defaults to <code class="docutils literal notranslate"><span class="pre">100</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – Requires a calculator to be loaded first.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.calculate.mbGDMLMD.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">steps</span></em>, <em class="sig-param"><span class="n">t_step</span></em>, <em class="sig-param"><span class="n">temp</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#mbGDMLMD.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.mbGDMLMD.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs a MD simulation using the Verlet algorithm in ASE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>steps</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of steps for the MD simulation.</p></li>
<li><p><strong>t_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>) – Time step in femtoseconds.</p></li>
<li><p><strong>temp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>) – Temperature in Kelvin used for initializing velocities.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#AttributeError" title="(in Python v3.9)"><strong>AttributeError</strong></a> – Requires a calculator to be loaded first.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mbgdml.calculate.partition_engrad">
<code class="sig-prename descclassname">mbgdml.calculate.</code><code class="sig-name descname">partition_engrad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">package</span></em>, <em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">job_name</span></em>, <em class="sig-param"><span class="n">input_name</span></em>, <em class="sig-param"><span class="n">output_name</span></em>, <em class="sig-param"><span class="n">theory</span></em>, <em class="sig-param"><span class="n">basis_set</span></em>, <em class="sig-param"><span class="n">charge</span></em>, <em class="sig-param"><span class="n">multiplicity</span></em>, <em class="sig-param"><span class="n">cluster</span></em>, <em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">cores</span></em>, <em class="sig-param"><span class="n">days</span></em>, <em class="sig-param"><span class="n">hours</span></em>, <em class="sig-param"><span class="n">calc_dir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">options</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">control_blocks</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">submit_script</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">write</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">submit</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/calculate.html#partition_engrad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.calculate.partition_engrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Partition ORCA 4 EnGrad calculation for trajectory.</p>
<p>Can be submitted using <code class="docutils literal notranslate"><span class="pre">sbatch</span></code> or just have the input files prepared.
Default submission script is set for University of Pittsburgh’s Center for
Research Computing cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>package</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Specifies the quantum chemistry program to be used. <code class="docutils literal notranslate"><span class="pre">'ORCA'</span></code> is
currently the only package directly supported.</p></li>
<li><p><strong>z</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> or <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code>
containing atomic numbers of atoms in the structures in order as they
appear for every <code class="docutils literal notranslate"><span class="pre">m</span></code> structure.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> or <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code> where
<code class="docutils literal notranslate"><span class="pre">m</span></code> is the number of structures and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of atoms with
three Cartesian components.</p></li>
<li><p><strong>job_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of the job for SLURM input file.</p></li>
<li><p><strong>input_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – File name for the input file.</p></li>
<li><p><strong>output_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – File name for the output file.</p></li>
<li><p><strong>theory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Keword that specifies the level of theory (e.g., MP2, BP86, B3LYP,
etc.) used for calculations. Defaults to ‘MP2’ for ORCA 4.2.0.</p></li>
<li><p><strong>basis_set</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Keyword that specifies the basis set (e.g., def2-SVP, def2-TZVP, etc.).
Defaults to ‘def2-TZVP’.</p></li>
<li><p><strong>charge</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – System charge. Defaults to <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>multiplicity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – System multiplicity. Defaults to <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></li>
<li><p><strong>cluster</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Name of cluster for calculations. For example, <code class="docutils literal notranslate"><span class="pre">'smp'</span></code>.</p></li>
<li><p><strong>nodes</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of requested nodes.</p></li>
<li><p><strong>cores</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Number of processing cores for the calculation.</p></li>
<li><p><strong>days</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Requested run time days.</p></li>
<li><p><strong>hours</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Requested run time hours.</p></li>
<li><p><strong>calc_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Path to write calculation. Defaults to current directory (<code class="docutils literal notranslate"><span class="pre">'.'</span></code>).</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – All options specifically for the EnGrad calculation (e.g., SCF
convergence criteria, algorithms, etc.).</p></li>
<li><p><strong>control_blocks</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – All options that control the calculation.</p></li>
<li><p><strong>submit_script</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – The SLURM submission script content. Defaults to
<code class="docutils literal notranslate"><span class="pre">pitt_crc_orca_submit</span></code>.</p></li>
<li><p><strong>write</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Whether or not to write the file. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>submit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Controls whether the calculation is submitted. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> – The SLURM submission script.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a> – The input file.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mbgdml.parse">
<span id="mbgdml-parse-module"></span><h2>mbgdml.parse module<a class="headerlink" href="#module-mbgdml.parse" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mbgdml.parse.cluster_size">
<code class="sig-prename descclassname">mbgdml.parse.</code><code class="sig-name descname">cluster_size</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">xyz_path</span></em>, <em class="sig-param"><span class="n">solvent</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/parse.html#cluster_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.parse.cluster_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines number of solvent molecules in a xyz file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xyz_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to xyz file of interest.</p></li>
<li><p><strong>solvent</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>) – Specifies solvents to determine the number of atoms included in a
molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of solvent molecules in specified xyz file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.parse.parse_cluster">
<code class="sig-prename descclassname">mbgdml.parse.</code><code class="sig-name descname">parse_cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">R</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/parse.html#parse_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.parse.parse_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates dictionary of all solvent molecules in solvent cluster from a
cluster_data dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code> containing atomic
numbers of atoms in the structures in order as they appear.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of atoms with three Cartesian components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a> keys specifying the molecule number starting from 0 with
nested <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> as values which contain</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'z'</span></code></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code> containing atomic
numbers of atoms in the structures in order as they appear.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'R'</span></code></dt><dd><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of atoms with three Cartesian components.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.parse.parse_coords">
<code class="sig-prename descclassname">mbgdml.parse.</code><code class="sig-name descname">parse_coords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">fileName</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/parse.html#parse_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.parse.parse_coords" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="mbgdml.parse.parse_engrad">
<code class="sig-prename descclassname">mbgdml.parse.</code><code class="sig-name descname">parse_engrad</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">out_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/parse.html#parse_engrad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.parse.parse_engrad" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses GDML-relevant data (coordinates, energies, and gradients)
from partition output file.</p>
<p>Uses <code class="xref py py-mod docutils literal notranslate"><span class="pre">cclib</span></code> to parse data from computational chemistry calculations
involving multiple calculations of structures containing same atoms in
different configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>out_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to computational chemistry output file. This should contain all MD
steps for the partition.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>All information needed to build GDML data sets. Contains the following
keys:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'z'</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">(n,)</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> of atomic numbers.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'R'</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> containing the coordinates of
<code class="docutils literal notranslate"><span class="pre">m</span></code> calculations of the <code class="docutils literal notranslate"><span class="pre">n</span></code> atoms in the structure.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'E'</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">1)</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> containing the energies of
<code class="docutils literal notranslate"><span class="pre">m</span></code> calculations.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'G'</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> containing the gradients of
<code class="docutils literal notranslate"><span class="pre">m</span></code> calculations of the <code class="docutils literal notranslate"><span class="pre">n</span></code> atoms in the structure.</p>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.parse.parse_stringfile">
<code class="sig-prename descclassname">mbgdml.parse.</code><code class="sig-name descname">parse_stringfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stringfile_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/parse.html#parse_stringfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.parse.parse_stringfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses data from string file.</p>
<p>A string file is data presented as consecutive xyz data. The data could be
three Cartesian coordinates for each atom, three atomic force vector
components, or both coordinates and atomic forces in one line (referred to
as extended xyz).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stringfile_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to string file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Parsed atoms (as element symbols <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>), comments, and data as
<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a> from string file.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tuple</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.parse.struct_dict">
<code class="sig-prename descclassname">mbgdml.parse.</code><code class="sig-name descname">struct_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin</span></em>, <em class="sig-param"><span class="n">struct_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/parse.html#struct_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.parse.struct_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-mbgdml.partition">
<span id="mbgdml-partition-module"></span><h2>mbgdml.partition module<a class="headerlink" href="#module-mbgdml.partition" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mbgdml.partition.partition_cluster">
<code class="sig-prename descclassname">mbgdml.partition.</code><code class="sig-name descname">partition_cluster</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cluster</span></em>, <em class="sig-param"><span class="n">nbody</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/partition.html#partition_cluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.partition.partition_cluster" title="Permalink to this definition">¶</a></dt>
<dd><p>All possible n-body combinations from a cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cluster</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>) – Dictionary of solvent molecules in cluster from
<a class="reference internal" href="#mbgdml.parse.parse_cluster" title="mbgdml.parse.parse_cluster"><code class="xref py py-func docutils literal notranslate"><span class="pre">parse_cluster()</span></code></a>.</p></li>
<li><p><strong>nbody</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – Desired number of solvent molecules in combination.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>All nonrepeating solvent molecule combinations from cluster with keys
being <code class="docutils literal notranslate"><span class="pre">'#,#,#'</span></code> where each <code class="docutils literal notranslate"><span class="pre">#</span></code> represents a molecule index. For
example, <code class="docutils literal notranslate"><span class="pre">'0,11,19'</span></code> would be a cluster with molecules 0, 11, and 19
from the super cluster. Each value is a dictionary containing</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'z'</span></code></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code> containing atomic
numbers of atoms in the structures in order as they appear.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'R'</span></code></dt><dd><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of atoms with three Cartesian components.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>0,1,2 is considered the same as 2,1,0 and only included once.</p>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.partition.partition_stringfile">
<code class="sig-prename descclassname">mbgdml.partition.</code><code class="sig-name descname">partition_stringfile</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file_path</span></em>, <em class="sig-param"><span class="n">max_nbody</span><span class="o">=</span><span class="default_value">4</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/partition.html#partition_stringfile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.partition.partition_stringfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Partitions an XYZ file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to trajectory with xyz coordinates.</p></li>
<li><p><strong>max_nbody</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>, optional) – Highest order of n-body structure to include.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>All nonrepeating molecule combinations from original cluster with keys
being uppercase concatenations of molecule labels and values being the
string of coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If any structure has a different order of atoms.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.partition.partition_structures">
<code class="sig-prename descclassname">mbgdml.partition.</code><code class="sig-name descname">partition_structures</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">max_nbody</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/partition.html#partition_structures"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.partition.partition_structures" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates all partitions from given atoms and coordinates.</p>
<p>Takes a cluster of molecules and separates into individual partitions. A
partition being a monomer, dimer, trimer, etc. from the original cluster.
For example, a structure of three solvent molecules will provide three
individual partitions of monomers, three dimers, and one trimer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code> containing atomic
numbers of atoms in the structures in order as they appear.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">m</span></code> is the
number of structures and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of atoms with three
Cartesian components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>All nonrepeating solvent molecule combinations from cluster with keys
being <code class="docutils literal notranslate"><span class="pre">'#,#,#'</span></code> where each <code class="docutils literal notranslate"><span class="pre">#</span></code> represents a molecule index. For
example, <code class="docutils literal notranslate"><span class="pre">'0,11,19'</span></code> would be a cluster with molecules 0, 11, and 19
from the super cluster. Each value is a dictionary containing</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'z'</span></code></dt><dd><p>A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code> containing atomic
numbers of atoms in the structures in order as they appear.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'R'</span></code></dt><dd><p>A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the
number of atoms with three Cartesian components.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.9)"><strong>ValueError</strong></a> – If any structure has a different order of atoms.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mbgdml.predict">
<span id="mbgdml-predict-module"></span><h2>mbgdml.predict module<a class="headerlink" href="#module-mbgdml.predict" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mbgdml.predict.mbGDMLPredict">
<em class="property">class </em><code class="sig-prename descclassname">mbgdml.predict.</code><code class="sig-name descname">mbGDMLPredict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">models</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/predict.html#mbGDMLPredict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Predict energies and forces of structures using GDML models.</p>
<dl class="py method">
<dt id="mbgdml.predict.mbGDMLPredict.decomposed_predict">
<code class="sig-name descname">decomposed_predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">R</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/predict.html#mbGDMLPredict.decomposed_predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict.decomposed_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes predicted total energy and atomic forces decomposed by
many-body order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code> containing atomic
numbers of atoms in the structures in order as they appear.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">m</span></code> is
the number of structures and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of atoms with three
Cartesian components.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionaries of many-body contributions of total energies
(float) and forces (np.ndarray) of the structure. Note that
forces has the same shape as R. Each key of the dictionary is
the order of the many-body model. Within this dictionary is a
total, ‘T’, and molecule combinations identified in the system
and their contributions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.9)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coords</span> <span class="o">=</span> <span class="n">array</span><span class="p">([[</span> <span class="mf">1.530147</span><span class="p">,</span>  <span class="mf">1.121901</span><span class="p">,</span>  <span class="mf">0.396232</span><span class="p">],</span>
<span class="go">                    [ 2.350485,  1.1297  , -0.085235],</span>
<span class="go">                    [ 0.823842,  1.311077, -0.2846  ],</span>
<span class="go">                    [-1.464849, -1.155867, -0.449863],</span>
<span class="go">                    [-1.41447 , -1.99605 , -0.917981],</span>
<span class="go">                    [-0.868584, -1.275659,  0.32329 ]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E_predicted</span><span class="p">,</span> <span class="n">F_predicted</span> <span class="o">=</span> <span class="n">decomposed_predict</span><span class="p">(</span><span class="n">atoms</span><span class="p">,</span> <span class="n">coords</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">E_predicted</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>  <span class="c1"># Units here are kcal/mol</span>
<span class="go">-95775.24328734782</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F_predicted</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>  <span class="c1"># Units here are kcal/(mol A)</span>
<span class="go">array([[-4.06668790e+01,  5.97564871e+00, -1.63273803e+01],</span>
<span class="go">       [ 1.10787347e+01,  6.38884805e-01, -9.01790818e+00],</span>
<span class="go">       [ 2.82554119e+01, -8.11473944e+00,  2.53684238e+01],</span>
<span class="go">       [ 1.45845554e+01, -2.53514310e+00,  1.76065017e+01],</span>
<span class="go">       [-3.53967582e-02,  2.91676403e-01,  2.61011071e-01],</span>
<span class="go">       [-1.32164262e+01,  3.74366076e+00, -1.78906481e+01]])</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.predict.mbGDMLPredict.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">R</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/predict.html#mbGDMLPredict.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts total energy and atomic forces using many-body GDML models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Atomic numbers of all atoms in the system.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – Cartesian coordinates of all atoms of the structure specified in
the same order as <code class="docutils literal notranslate"><span class="pre">z</span></code>. The array should have shape <code class="docutils literal notranslate"><span class="pre">(n,</span> <span class="pre">3)</span></code>
where <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of atoms.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a> – Total energy of the system.</p></li>
<li><p>obj:<cite>numpy.ndarray – Atomic forces of the system in the same shape as ``R`</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.predict.mbGDMLPredict.remove_nbody">
<code class="sig-name descname">remove_nbody</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ref_dataset</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/predict.html#mbGDMLPredict.remove_nbody"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.predict.mbGDMLPredict.remove_nbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes mbGDML prediced energies and forces from a reference data
set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ref_dataset</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>) – Contains all data as <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> objects.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mbgdml.solvents">
<span id="mbgdml-solvents-module"></span><h2>mbgdml.solvents module<a class="headerlink" href="#module-mbgdml.solvents" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mbgdml.solvents.solvent">
<em class="property">class </em><code class="sig-prename descclassname">mbgdml.solvents.</code><code class="sig-name descname">solvent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/solvents.html#solvent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.solvents.solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Identifies and describes the solvent for MB-GDML.</p>
<p>Represents the solvent that makes up the cluster MB-GDML is being trained
from.</p>
<dl class="py attribute">
<dt id="mbgdml.solvents.solvent.system">
<code class="sig-name descname">system</code><a class="headerlink" href="#mbgdml.solvents.solvent.system" title="Permalink to this definition">¶</a></dt>
<dd><p>Designates what kind of system this is. Currently only ‘solvent’
systems.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="mbgdml.solvents.solvent.solvent_name">
<code class="sig-name descname">solvent_name</code><a class="headerlink" href="#mbgdml.solvents.solvent.solvent_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the solvent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="mbgdml.solvents.solvent.solvent_label">
<code class="sig-name descname">solvent_label</code><a class="headerlink" href="#mbgdml.solvents.solvent.solvent_label" title="Permalink to this definition">¶</a></dt>
<dd><p>A label for the solvent for filenaming purposes.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="mbgdml.solvents.solvent.solvent_molec_size">
<code class="sig-name descname">solvent_molec_size</code><a class="headerlink" href="#mbgdml.solvents.solvent.solvent_molec_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of atoms in one solvent molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="mbgdml.solvents.solvent.cluster_size">
<code class="sig-name descname">cluster_size</code><a class="headerlink" href="#mbgdml.solvents.solvent.cluster_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Total number of solvent molecules in cluster.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.solvents.solvent.atom_numbers">
<code class="sig-name descname">atom_numbers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chem_formula</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/solvents.html#solvent.atom_numbers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.solvents.solvent.atom_numbers" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides a dictionary of atoms and their quantity from chemical
formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>chem_formula</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – The chemical formula of a single solvent  molecule. For example,
‘CH3OH’ for methanol, ‘H2O’ for water, and ‘C2H3N’ for acetonitrile.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Contains the atoms as their elemental symbol for keys and their
quantity as values.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">atom_numbers</span><span class="p">(</span><span class="s1">&#39;CH3OH&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.solvents.solvent.identify_solvent">
<code class="sig-name descname">identify_solvent</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom_list</span></em>, <em class="sig-param"><span class="n">all_solvents</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/solvents.html#solvent.identify_solvent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.solvents.solvent.identify_solvent" title="Permalink to this definition">¶</a></dt>
<dd><p>Identifies the solvent from a repeated list of elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – Elements as strings. Elements should be repeated. For example,
[‘H’, ‘H’, ‘O’, ‘O’, ‘H’, ‘H’]. Note that the order does not
matter; only the quantity.</p></li>
<li><p><strong>all_solvents</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><em>dict</em></a>) – Contains all solvents described in solvents.json. Keys are the name
of the solvent, and the values are dicts ‘label’ and ‘formula’ that
provide a solvent label and chemical formula, respectively.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="mbgdml.solvents.system_info">
<code class="sig-prename descclassname">mbgdml.solvents.</code><code class="sig-name descname">system_info</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atoms</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/solvents.html#system_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.solvents.system_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines information about the system key to mbGDML.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atoms</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>) – Atomic numbers of all atoms in the system.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>System information useful for mbGDML. Always will contain the following
key:</p>
<p><code class="docutils literal notranslate"><span class="pre">'system'</span></code></p>
<p>If <code class="docutils literal notranslate"><span class="pre">'system'</span></code> is equal to <code class="docutils literal notranslate"><span class="pre">'solvent'</span></code>, then the following keys will
be included:</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'solvent_name'</span></code></dt><dd><p>Common name for the identified solvent.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'solvent_label'</span></code></dt><dd><p>Standardized shorthand label for the solvent.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'solvent_molec_size'</span></code></dt><dd><p>Number of atoms in a single solvent molecule.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'cluster_size'</span></code></dt><dd><p>Number of solvent molecules in the cluster.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a ‘solvent’ system the additional information returned is the
‘solvent_name’, ‘solvent_label’, ‘solvent_molec_size’, and ‘cluster_size’.</p>
</dd></dl>

</div>
<div class="section" id="module-mbgdml.train">
<span id="mbgdml-train-module"></span><h2>mbgdml.train module<a class="headerlink" href="#module-mbgdml.train" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="mbgdml.train.mbGDMLTrain">
<em class="property">class </em><code class="sig-prename descclassname">mbgdml.train.</code><code class="sig-name descname">mbGDMLTrain</code><a class="reference internal" href="../_modules/mbgdml/train.html#mbGDMLTrain"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.train.mbGDMLTrain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.9)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py attribute">
<dt id="mbgdml.train.mbGDMLTrain.dataset_path">
<code class="sig-name descname">dataset_path</code><a class="headerlink" href="#mbgdml.train.mbGDMLTrain.dataset_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Path to data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="mbgdml.train.mbGDMLTrain.dataset_name">
<code class="sig-name descname">dataset_name</code><a class="headerlink" href="#mbgdml.train.mbGDMLTrain.dataset_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Data set file name without extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="mbgdml.train.mbGDMLTrain.dataset">
<code class="sig-name descname">dataset</code><a class="headerlink" href="#mbgdml.train.mbGDMLTrain.dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>mbGDML data set for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.train.mbGDMLTrain.load_dataset">
<code class="sig-name descname">load_dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset_path</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/train.html#mbGDMLTrain.load_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.train.mbGDMLTrain.load_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a GDML dataset from npz format from specified path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataset_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to NumPy npz file representing a GDML dataset of a single
cluster size (e.g., two water molecules).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="mbgdml.train.mbGDMLTrain.train_GDML">
<code class="sig-name descname">train_GDML</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model_name</span></em>, <em class="sig-param"><span class="n">num_train</span></em>, <em class="sig-param"><span class="n">num_validate</span></em>, <em class="sig-param"><span class="n">num_test</span></em>, <em class="sig-param"><span class="n">sigma_range</span><span class="o">=</span><span class="default_value">'2:10:100'</span></em>, <em class="sig-param"><span class="n">save_dir</span><span class="o">=</span><span class="default_value">'.'</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">torch</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/train.html#mbGDMLTrain.train_GDML"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.train.mbGDMLTrain.train_GDML" title="Permalink to this definition">¶</a></dt>
<dd><p>Trains a GDML model through the command line interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – User-defined model name.</p></li>
<li><p><strong>num_train</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – The number of training points to sample.</p></li>
<li><p><strong>num_validate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – The number of validation points to sample, without replacement.</p></li>
<li><p><strong>num_test</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>) – The number of test points to test the validated GDML model.</p></li>
<li><p><strong>sigma_range</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Range of kernel length scales to train and validate GDML values
one. Format is <cite>&lt;start&gt;:&lt;interval&gt;:&lt;stop&gt;</cite>. Note, the more length
scales the longer the training time. Two is the minimum value.</p></li>
<li><p><strong>save_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>, optional) – Path to train and save the mbGDML model. Defaults to current
directory.</p></li>
<li><p><strong>overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Overwrite existing files. Defaults to false.</p></li>
<li><p><strong>torch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>, optional) – Use PyTorch to enable GPU acceleration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mbgdml.utils">
<span id="mbgdml-utils-module"></span><h2>mbgdml.utils module<a class="headerlink" href="#module-mbgdml.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="mbgdml.utils.atoms_by_element">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">atoms_by_element</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#atoms_by_element"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.atoms_by_element" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a list of atoms identified by their atomic number to their
elemental symbol in the same order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>]) – Atomic numbers of atoms within a structure.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Element symbols of atoms within a structure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.utils.atoms_by_number">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">atoms_by_number</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">atom_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#atoms_by_number"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.atoms_by_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a list of atoms identified by their elemental symbol to their
atomic number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>atom_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>]) – Element symbols of atoms within a structure.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Atomic numbers of atoms within a structure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.utils.convert_forces">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">convert_forces</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">forces</span></em>, <em class="sig-param"><span class="n">e_units_calc</span></em>, <em class="sig-param"><span class="n">r_units_calc</span></em>, <em class="sig-param"><span class="n">e_units</span></em>, <em class="sig-param"><span class="n">r_units</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#convert_forces"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.convert_forces" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts forces (or gradients) to specified units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>forces</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – An array with units of energy and distance matching <cite>e_units_calc</cite>
and <cite>r_units_calc</cite>.</p></li>
<li><p><strong>e_units_calc</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Specifies package-specific energy units used in calculation. Available
units are <code class="docutils literal notranslate"><span class="pre">'eV'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hartree'</span></code>, <code class="docutils literal notranslate"><span class="pre">'kcal/mol'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'kJ/mol'</span></code>.</p></li>
<li><p><strong>r_units_calc</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Specifies package-specific distance units used in calculation. Available
units are <code class="docutils literal notranslate"><span class="pre">'Angstrom'</span></code> and <code class="docutils literal notranslate"><span class="pre">'bohr'</span></code>.</p></li>
<li><p><strong>e_units</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Desired units of energy. Available units are <code class="docutils literal notranslate"><span class="pre">'eV'</span></code>, <code class="docutils literal notranslate"><span class="pre">'hartree'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'kcal/mol'</span></code>, and <code class="docutils literal notranslate"><span class="pre">'kJ/mol'</span></code>.</p></li>
<li><p><strong>r_units</strong> (obj:<cite>str</cite>) – Desired units of distance. Available units are <code class="docutils literal notranslate"><span class="pre">'Angstrom'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'bohr'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Forces converted into the desired units.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.utils.get_files">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">get_files</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">expression</span></em>, <em class="sig-param"><span class="n">recursive</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#get_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.get_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns paths to all files in a given directory that matches a provided
expression in the file name. Commonly used to find all files of a certain
type, e.g. output or xyz files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Specifies the directory to search.</p></li>
<li><p><strong>expression</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Expression to be tested against all file names in ‘path’.</p></li>
</ul>
</dd>
</dl>
<p>:param recursive <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>: Recursively find all files in all subdirectories.
:param optional: Recursively find all files in all subdirectories.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>All absolute paths to files matching the provided expression.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a> [<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.utils.natsort_list">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">natsort_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">unsorted_list</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#natsort_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.natsort_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic function that organizes a list based on human (or natural) sorting
methodology.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>unsorted_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)"><em>list</em></a>) – List of strings.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Sorted list of string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.utils.norm_path">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">norm_path</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#norm_path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.norm_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalizes directory paths to be consistent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><em>str</em></a>) – Path to a directory.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Normalized path.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.utils.string_coords">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">string_coords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">R</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#string_coords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.string_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Puts atomic coordinates into a Python string. Typically used for
writing to an input file.</p>
<p>Parameters
atoms : <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></p>
<blockquote>
<div><p>A (n,) numpy array containing all <code class="docutils literal notranslate"><span class="pre">n</span></code> elements labled by their atomic
number.</p>
</div></blockquote>
<dl>
<dt>coords<span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.array</span></code></a></span></dt><dd><p>Contains atomic positions in a (n, 3) numpy array where the x, y, and z
Cartesian coordinates in Angstroms are given for the n atoms.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>XYZ atomic coordinates as a string.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="mbgdml.utils.write_xyz">
<code class="sig-prename descclassname">mbgdml.utils.</code><code class="sig-name descname">write_xyz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">z</span></em>, <em class="sig-param"><span class="n">R</span></em>, <em class="sig-param"><span class="n">save_dir</span></em>, <em class="sig-param"><span class="n">file_name</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mbgdml/utils.html#write_xyz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mbgdml.utils.write_xyz" title="Permalink to this definition">¶</a></dt>
<dd><p>Write XYZ file given atomic numbers and Cartesian coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <code class="docutils literal notranslate"><span class="pre">(n,)</span></code> shape array of type <code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.int32</span></code> containing atomic
numbers of atoms in the structures in order as they appear.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – A <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.19)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a> with shape of <code class="docutils literal notranslate"><span class="pre">(m,</span> <span class="pre">n,</span> <span class="pre">3)</span></code> where <code class="docutils literal notranslate"><span class="pre">m</span></code> is the
number of structures and <code class="docutils literal notranslate"><span class="pre">n</span></code> is the number of atoms with three
Cartesian components.</p></li>
<li><p><strong>save_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Path to directory to save XYZ file.</p></li>
<li><p><strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.9)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>) – Name to save the file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mbgdml">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-mbgdml" title="Permalink to this headline">¶</a></h2>
<p>Top-level package for mbgdml.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="mbgdml.analysis.html" class="btn btn-neutral float-right" title="mbgdml.analysis package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="modules.html" class="btn btn-neutral float-left" title="mbgdml" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, Alex M. Maldonado.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>